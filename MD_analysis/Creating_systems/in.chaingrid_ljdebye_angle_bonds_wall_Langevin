######################### Setting the sytem ####################################
# Set variables
variable theta0 equal 180.0
variable ljparam equal 1.042 # Taken from Bathe GAG paper
variable ljcutoff equal 2.0^(1.0/6.0) 
variable sigma equal 1.0
variable Kbond equal 2000.0
variable Kangle equal 15.0
variable T equal 310
variable kappa equal 1.0
variable debyecutoff equal 3.0

# 3d Lennard-Jones gas
units nano
dimension 3
boundary p p f
atom_style full
pair_style lj/cut/coul/debye ${kappa} ${ljcutoff} ${debyecutoff} 
bond_style harmonic
angle_style harmonic

# Making the atoms:
read_data data.chaingrids_N909_Nchains9_Ly3_twofixed #_straight

velocity all create $T 87287 # I can reset the velocities.

pair_coeff * * ${ljparam} ${sigma}
bond_coeff * ${Kbond} 1.0
angle_coeff * ${Kangle} ${theta0}

############################ Make snapshot #####################################

# Minimize really messes up the structure
#minimize 1.0e-4 1.0e-6 100 1000

group movingmonomers type 2

neighbor 1.0 bin
#neigh_modify once no every 1 delay 0 check yes

fix wallmembrane movingmonomers wall/lj126 zlo 0.0 ${ljparam} 1.0 2.5 units box

fix lgvfix movingmonomers langevin $T $T 100.0 699483
fix 1 movingmonomers nve

log log.chaingrid_quadratic_M9N101_ljdebye_epsilon${ljparam}_sigma${sigma}_ljcutoff${ljcutoff}_kappa${kappa}_debyecutoff${debyecutoff}_Langevin_wall${ljparam}_Kangle${Kangle}_Kbond${Kbond}_T$T_theta0is180_twofirst_are_fixed
dump 1 all custom 10000 chaingrid_quadratic_M9N101_ljdebye_epsilon${ljparam}_sigma${sigma}_ljcutoff${ljcutoff}_kappa${kappa}_debyecutoff${debyecutoff}_Langevin_wall${ljparam}_Kangle${Kangle}_Kbond${Kbond}_T$T_theta0is180_twofirst_are_fixed.lammpstrj id type mol x y z vx vy vz # For visualization
thermo 10000
run 10000000
